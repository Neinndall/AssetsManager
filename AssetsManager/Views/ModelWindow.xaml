<UserControl x:Class="AssetsManager.Views.ModelWindow"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="clr-namespace:AssetsManager.Views.Controls.Models"
             xmlns:materialIcons="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
             mc:Ignorable="d" FontFamily="{StaticResource AppFontFamily}">
    <Grid>
        <!-- CUERPO -->
        <Grid>
            <!-- LANDING PAGE / EMPTY STATE -->
            <Grid x:Name="EmptyStatePanel" Visibility="Visible">
                <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                    
                    <!-- Default Content (Buttons) -->
                    <StackPanel x:Name="DefaultEmptyStateContent" Visibility="Visible">
                        <!-- HERO HEADER: Centered Model -->
                        <StackPanel Margin="0,0,0,32" HorizontalAlignment="Center">
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,0,0,8">
                                <Border Background="#1A00E676" CornerRadius="4" Padding="8,3" VerticalAlignment="Center" Margin="0,0,10,0">
                                    <TextBlock Text="3D WORKSPACE" FontSize="11" FontWeight="Bold" Foreground="{StaticResource AccentGreen}"/>
                                </Border>
                                <TextBlock Text="INTERACTIVE STUDIO" FontSize="11" FontWeight="Bold" Foreground="{StaticResource TextSecondary}" VerticalAlignment="Center" Opacity="0.7"/>
                            </StackPanel>
                            <TextBlock Text="Model Viewer" FontSize="42" FontWeight="SemiBold" Foreground="{StaticResource TextPrimary}" HorizontalAlignment="Center" Margin="-2,0,0,0"/>
                            <TextBlock Text="Visualize characters, animations, and map geometry in real-time." FontSize="14" Foreground="{StaticResource TextSecondary}" HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.8"/>
                        </StackPanel>

                        <!-- Action Cards -->
                        <UniformGrid Columns="3" HorizontalAlignment="Center">
                            <!-- Load Model Card -->
                            <Button Style="{StaticResource SelectionCardButtonStyle}"
                                    Click="OpenFile_Click"
                                    ToolTip="Load a standard .skn model"
                                    Width="180" Height="160">
                                <StackPanel>
                                    <Border Background="{StaticResource SidebarBackground}" CornerRadius="25" Width="50" Height="50" Margin="0,0,0,16">
                                        <materialIcons:MaterialIcon Kind="CubeOutline" Width="24" Height="24" Foreground="{StaticResource AccentBrush}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="Load Character" 
                                               FontWeight="SemiBold" 
                                               FontSize="14" 
                                               Foreground="{StaticResource TextPrimary}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Import .skn files" 
                                               FontSize="12" 
                                               Foreground="{StaticResource TextMuted}" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </Button>

                            <!-- Load Chroma Card -->
                            <Button Style="{StaticResource SelectionCardButtonStyle}"
                                    Click="OpenChromaFile_Click"
                                    ToolTip="Load a model with custom textures"
                                    Width="180" Height="160">
                                <StackPanel>
                                    <Border Background="{StaticResource SidebarBackground}" CornerRadius="25" Width="50" Height="50" Margin="0,0,0,16">
                                        <materialIcons:MaterialIcon Kind="Palette" Width="24" Height="24" Foreground="{StaticResource AccentPurple}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="Load Chroma" 
                                               FontWeight="SemiBold" 
                                               FontSize="14" 
                                               Foreground="{StaticResource TextPrimary}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Model + Textures" 
                                               FontSize="12" 
                                               Foreground="{StaticResource TextMuted}" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </Button>

                            <!-- Load Map Card -->
                            <Button Style="{StaticResource SelectionCardButtonStyle}"
                                    Click="OpenGeometryFile_Click"
                                    ToolTip="Load map geometry"
                                    Width="180" Height="160">
                                <StackPanel>
                                    <Border Background="{StaticResource SidebarBackground}" CornerRadius="25" Width="50" Height="50" Margin="0,0,0,16">
                                        <materialIcons:MaterialIcon Kind="Map" Width="24" Height="24" Foreground="{StaticResource AccentOrange}" VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                    </Border>
                                    <TextBlock Text="Load Map" 
                                               FontWeight="SemiBold" 
                                               FontSize="14" 
                                               Foreground="{StaticResource TextPrimary}" 
                                               HorizontalAlignment="Center"/>
                                    <TextBlock Text="Import .mapgeo" 
                                               FontSize="12" 
                                               Foreground="{StaticResource TextMuted}" 
                                               HorizontalAlignment="Center" 
                                               Margin="0,4,0,0"/>
                                </StackPanel>
                            </Button>
                        </UniformGrid>
                    </StackPanel>
                    
                    <!-- Loading Indicator (Enhanced) -->
                    <Grid x:Name="LoadingStateContent" Visibility="Collapsed" Margin="0">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <!-- Animated Spinner (Explorer Style) -->
                            <materialIcons:MaterialIcon Kind="Loading" 
                                                        Width="38" 
                                                        Height="38" 
                                                        Foreground="{StaticResource AccentBrush}"
                                                        HorizontalAlignment="Center"
                                                        Margin="0,0,0,12"
                                                        RenderTransformOrigin="0.5, 0.5">
                                <materialIcons:MaterialIcon.RenderTransform>
                                    <RotateTransform Angle="0"/>
                                </materialIcons:MaterialIcon.RenderTransform>
                                <materialIcons:MaterialIcon.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(RotateTransform.Angle)" 
                                                                 From="0" To="360" Duration="0:0:1" 
                                                                 RepeatBehavior="Forever"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </materialIcons:MaterialIcon.Triggers>
                            </materialIcons:MaterialIcon>

                            <!-- Title -->
                            <TextBlock Text="Loading MapGeometry..."
                                       FontSize="24"
                                       FontWeight="Bold"
                                       Foreground="{StaticResource TextPrimary}"
                                       HorizontalAlignment="Center" 
                                       Margin="0,0,0,8"/>

                            <!-- Description -->
                            <TextBlock Text="Processing geometry and resizing textures."
                                       FontSize="14"
                                       Foreground="{StaticResource TextSecondary}"
                                       HorizontalAlignment="Center"
                                       TextAlignment="Center"/>
                        </StackPanel>
                    </Grid>

                </StackPanel>
            </Grid>

            <!-- MAIN CONTENT (Viewport + Panel) -->
            <Grid x:Name="MainContentGrid" Visibility="Collapsed">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="320" MinWidth="280" MaxWidth="450"/>
                </Grid.ColumnDefinitions>

                <!-- Column 0: Viewport -->
                <models:ModelViewportControl Grid.Column="0" x:Name="ViewportControl" MaximizeClicked="ViewportControl_MaximizeClicked"/>

                <!-- Column 1: Splitter -->
                <GridSplitter Grid.Column="1"
                              x:Name="MainGridSplitter"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Stretch"
                              Width="4"
                              Background="Transparent"
                              ResizeBehavior="PreviousAndNext"
                              ResizeDirection="Columns"/>
                
                <!-- Column 2: Controls Panel -->
                <models:ModelPanelControl Grid.Column="2" x:Name="PanelControl"/>
            </Grid>
        </Grid>
    </Grid>
</UserControl>
