<UserControl x:Class="AssetsManager.Views.Controls.Comparator.WadComparisonControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:AssetsManager.Views.Controls.Comparator"
             xmlns:materialIcons="clr-namespace:Material.Icons.WPF;assembly=Material.Icons.WPF"
             mc:Ignorable="d">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>

    <StackPanel>
        <!-- Main Comparison Card -->
        <Border Style="{StaticResource SettingsCard}" Padding="0">
            <StackPanel>
                
                <!-- CARD HEADER & MODE SELECTOR -->
                <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1" Padding="24,20" Background="{StaticResource SidebarBackground}" CornerRadius="8,8,0,0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/> <!-- Icon Box -->
                            <ColumnDefinition Width="*"/>    <!-- Texts -->
                            <ColumnDefinition Width="Auto"/> <!-- Selector -->
                        </Grid.ColumnDefinitions>
                        
                        <!-- Icon Box -->
                        <Border Grid.Column="0" Background="{StaticResource HoverColor}" CornerRadius="8" Width="44" Height="44" Margin="0,0,16,0">
                            <materialIcons:MaterialIcon Kind="SourceBranch" 
                                                       Foreground="{StaticResource AccentBrush}"
                                                       Width="22" Height="22"
                                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        
                        <!-- Titles -->
                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                            <TextBlock Text="WAD Comparator" FontWeight="Bold" FontSize="16" Foreground="{StaticResource TextPrimary}"/>
                            <TextBlock Text="Compare versions to identify new and modified assets" FontSize="12" Foreground="{StaticResource TextSecondary}" Margin="0,2,0,0"/>
                        </StackPanel>

                        <!-- Segmented Control -->
                        <Border Grid.Column="2" Background="{DynamicResource SidebarBackground}" CornerRadius="6" Padding="3" VerticalAlignment="Center" BorderBrush="{DynamicResource BorderColor}" BorderThickness="1">
                            <StackPanel Orientation="Horizontal">
                                <RadioButton x:Name="ModeDirectory" 
                                             Content="Directory" 
                                             GroupName="ComparisonMode"
                                             IsChecked="True" 
                                             Style="{StaticResource SegmentedRadioButtonStyle}"/>
                                <RadioButton x:Name="ModeFile" 
                                             Content="Single File" 
                                             GroupName="ComparisonMode"
                                             Style="{StaticResource SegmentedRadioButtonStyle}"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!-- CONTENT AREA -->
                <StackPanel Margin="24">
                    
                    <!-- MODE: DIRECTORY -->
                    <StackPanel Visibility="{Binding IsChecked, ElementName=ModeDirectory, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                    <materialIcons:MaterialIcon Kind="FolderStarOutline" Foreground="{StaticResource AccentGreen}" Width="18" Height="18" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="New Directory" FontWeight="SemiBold" FontSize="14" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBox x:Name="newLolPbeDirectoryTextBox" Style="{StaticResource ModernTextBox}" Height="36" IsReadOnly="True" Padding="10,0"/>
                            </StackPanel>

                            <Button Grid.Column="1" Click="btnSelectNewLolPbeDirectory_Click" Style="{StaticResource SecondaryButton}" VerticalAlignment="Bottom" ToolTip="Browse New Directory">
                                <materialIcons:MaterialIcon Kind="FolderOpenOutline" Width="18" Height="18"/>
                            </Button>
                        </Grid>

                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/> <!-- Button -->
                            </Grid.ColumnDefinitions>
                            
                            <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                    <materialIcons:MaterialIcon Kind="FolderClockOutline" Foreground="{StaticResource AccentOrange}" Width="18" Height="18" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="Old Directory" FontWeight="SemiBold" FontSize="14" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBox x:Name="oldLolPbeDirectoryTextBox" Style="{StaticResource ModernTextBox}" Height="36" IsReadOnly="True" Padding="10,0"/>
                            </StackPanel>
                            
                            <Button Grid.Column="1" Click="btnSelectOldLolPbeDirectory_Click" Style="{StaticResource SecondaryButton}" VerticalAlignment="Bottom" ToolTip="Browse Old Directory">
                                <materialIcons:MaterialIcon Kind="FolderOpenOutline" Width="18" Height="18"/>
                            </Button>
                        </Grid>
                    </StackPanel>

                    <!-- MODE: FILE -->
                    <StackPanel Visibility="{Binding IsChecked, ElementName=ModeFile, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                    <materialIcons:MaterialIcon Kind="FileStarOutline" Foreground="{StaticResource AccentGreen}" Width="18" Height="18" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="New WAD File" FontWeight="SemiBold" FontSize="14" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBox x:Name="newWadFileTextBox" Style="{StaticResource ModernTextBox}" Height="36" IsReadOnly="True" Padding="10,0"/>
                            </StackPanel>

                            <Button Grid.Column="1" Click="btnSelectNewWadFile_Click" Style="{StaticResource SecondaryButton}" VerticalAlignment="Bottom" ToolTip="Browse New File">
                                <materialIcons:MaterialIcon Kind="FileFindOutline" Width="18" Height="18"/>
                            </Button>
                        </Grid>

                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Margin="0,0,12,0">
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                                    <materialIcons:MaterialIcon Kind="FileClockOutline" Foreground="{StaticResource AccentOrange}" Width="18" Height="18" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="Old WAD File" FontWeight="SemiBold" FontSize="14" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBox x:Name="oldWadFileTextBox" Style="{StaticResource ModernTextBox}" Height="36" IsReadOnly="True" Padding="10,0"/>
                            </StackPanel>

                            <Button Grid.Column="1" Click="btnSelectOldWadFile_Click" Style="{StaticResource SecondaryButton}" VerticalAlignment="Bottom" ToolTip="Browse Old File">
                                <materialIcons:MaterialIcon Kind="FileFindOutline" Width="18" Height="18"/>
                            </Button>
                        </Grid>
                    </StackPanel>

                </StackPanel>

                <!-- ACTION FOOTER -->
                <Border BorderBrush="{StaticResource BorderColor}" BorderThickness="0,1,0,0" Padding="24" Background="{StaticResource SidebarBackground}" CornerRadius="0,0,8,8">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                            <materialIcons:MaterialIcon Kind="CheckCircleOutline" 
                                                       Foreground="{StaticResource AccentBrush}"
                                                       Width="24" Height="24"
                                                       Margin="0,0,12,0"
                                                       VerticalAlignment="Center"/>
                            <StackPanel VerticalAlignment="Center">
                                <TextBlock Text="Ready to Compare?" FontWeight="Bold" Foreground="{StaticResource TextPrimary}"/>
                                <TextBlock Text="The process might take a while depending on file size." FontSize="11" Foreground="{StaticResource TextMuted}" Margin="0,2,0,0"/>
                            </StackPanel>
                        </StackPanel>

                        <Button x:Name="compareWadButton" 
                                Grid.Column="1"
                                Click="compareWadButton_Click"
                                Style="{StaticResource ModernButton}"
                                Height="40"
                                Padding="12,0">
                            <StackPanel Orientation="Horizontal">
                                <materialIcons:MaterialIcon Kind="PlayCircleOutline" Margin="0,0,8,0" Width="16" Height="16" VerticalAlignment="Center"/>
                                <TextBlock Text="START COMPARISON" FontWeight="Bold" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </Grid>
                </Border>
            </StackPanel>
        </Border>
    </StackPanel>
</UserControl>